const requisitos = {
  'ramo13': ['ramo2'],
  'ramo14': ['ramo8'],
  'ramo15': ['ramo9'],
  'ramo16': ['ramo3'],
  'ramo17': ['ramo12'],

  'ramo18': ['ramo13'],
  'ramo19': ['ramo14'],
  'ramo20': ['ramo15'],
  'ramo21': ['ramo16'],
  'ramo22': ['ramo10'],
  'ramo23': ['ramo17'],

  'ramo24': ['ramo18'],
  'ramo25': ['ramo19'],
  'ramo26': ['ramo20'],
  'ramo27': ['ramo21'],
  'ramo29': ['ramo23'],

  'ramo30': ['ramo24'],
  'ramo31': ['ramo25'],
  'ramo32': ['ramo26'],
  'ramo33': ['ramo21'],
  'ramo34': ['ramo28'],
  'ramo35': ['ramo29'],

  'ramo36': ['ramo30'],
  'ramo37': ['ramo31'],
  'ramo38': ['ramo32'],
  'ramo39': ['ramo33'],
  'ramo40': ['ramo30'],
  'ramo41': ['ramo35'],

  'ramo42': ['ramo40'],
  'ramo43': ['ramo36', 'ramo37', 'ramo38'],
  'ramo44': ['ramo37', 'ramo38'],
  'ramo46': ['ramo43'],
  'ramo47': ['ramo36', 'ramo38'],
  'ramo48': ['ramo36', 'ramo38'],
  'ramo49': ['ramo36', 'ramo38'],
  'ramo50': ['ramo36', 'ramo38'],
  'ramo51': ['ramo36', 'ramo38'],
  'ramo52': ['ramo41']
};

window.addEventListener('DOMContentLoaded', () => {
  const ramos = document.querySelectorAll('.ramo');

  ramos.forEach(ramo => {
    const id = ramo.id;
    const reqs = requisitos[id];

    if (reqs && reqs.length > 0) {
      ramo.classList.add('bloqueado');
    }

    ramo.addEventListener('click', () => {
      if (ramo.classList.contains('bloqueado') || ramo.classList.contains('aprobado')) return;

      // Marcar como aprobado solo una vez
      ramo.classList.remove('bloqueado', 'desbloqueado');
      ramo.classList.add('aprobado');

      // Desbloquear los ramos dependientes
      ramos.forEach(r => {
        const rId = r.id;
        const rReqs = requisitos[rId];

        if (!rReqs || r.classList.contains('aprobado')) return;

        const puedeDesbloquear = rReqs.every(reqId => {
          const reqEl = document.getElementById(reqId);
          return reqEl && reqEl.classList.contains('aprobado');
        });

        if (puedeDesbloquear) {
          r.classList.remove('bloqueado');
          r.classList.add('desbloqueado');
        }
      });
    });
  });
});
